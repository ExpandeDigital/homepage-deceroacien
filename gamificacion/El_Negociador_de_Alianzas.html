<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego: El Negociador de Alianzas - DE CERO A CIEN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-noche: #1a1f3a;
            --dorado: #d4af37;
            --texto-claro: #e0e1e9;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--azul-noche);
            color: var(--texto-claro);
        }
        .font-serif { font-family: 'Playfair Display', serif; }
        .info-section .info-item { display: flex; align-items: flex-start; margin-bottom: 1.25rem; }
        .info-section .info-icon { flex-shrink: 0; width: 24px; height: 24px; margin-right: 12px; margin-top: 2px; font-size: 20px; }
        .chat-bubble { max-width: 80%; }
        .chat-bubble.user { background-color: var(--dorado); color: var(--azul-noche); }
        .chat-bubble.partner { background-color: #2a3154; }
        .option-button {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease-in-out;
        }
        .option-button:hover {
            border-color: var(--dorado);
            background-color: rgba(212, 175, 55, 0.1);
        }
        .option-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
    <link rel="stylesheet" href="../assets/styles/common.css">
    <link rel="stylesheet" href="../assets/styles/mobile.css">
</head>
<body class="base-container antialiased bg-[var(--azul-noche)]">
    <header class="header-component"></header>
    <main class="main-content">
        <section class="main-section py-4">
            <div class="section-container">
                <a href="index.html" class="text-sm text-gray-400 hover:text-gray-200">‚Üê Volver a Gamificaci√≥n</a>
            </div>
        </section>
        <div class="flex items-center justify-center min-h-screen p-4">

    <!-- Pantalla de Informaci√≥n Inicial -->
    <div id="info-screen" class="w-full max-w-2xl mx-auto">
        <h1 class="font-serif text-3xl font-bold text-center text-white mb-6">El Negociador de Alianzas</h1>
        <div class="bg-black/20 p-6 rounded-lg text-sm text-[var(--texto-claro)] border border-white/10">
            <p class="font-bold text-lg text-center text-white mb-6">Herramienta de la Fase 5: Consolidaci√≥n y Madurez</p>
            <div class="info-section space-y-4">
                <div class="info-item">
                    <span class="info-icon">üéØ</span>
                    <div>
                        <h3 class="font-bold text-white">Objetivo</h3>
                        <p class="text-gray-300">Desarrollar habilidades de negociaci√≥n y comunicaci√≥n estrat√©gica para forjar alianzas B2B exitosas que impulsen el crecimiento del negocio en su etapa de madurez.</p>
                    </div>
                </div>
                <div class="info-item">
                    <span class="info-icon">‚≠ê</span>
                    <div>
                        <h3 class="font-bold text-white">Importancia</h3>
                        <p class="text-gray-300">Saber negociar es fundamental para cerrar acuerdos estrat√©gicos. Una buena negociaci√≥n crea relaciones a largo plazo; una mala puede destruirlas antes de empezar.</p>
                    </div>
                </div>
                <div class="info-item">
                    <span class="info-icon">‚öôÔ∏è</span>
                    <div>
                        <h3 class="font-bold text-white">¬øQu√© es lo que hace?</h3>
                        <p class="text-gray-300">Este juego te sumerge en una conversaci√≥n con un socio potencial (IA). Deber√°s elegir las opciones de di√°logo correctas para balancear tus objetivos y los de tu contraparte para llegar a un acuerdo "ganar-ganar".</p>
                    </div>
                </div>
                <div class="info-item">
                    <span class="info-icon">üí°</span>
                    <div>
                        <h3 class="font-bold text-white">¬øPara qu√© me sirve?</h3>
                        <p class="text-gray-300">Para practicar la empat√≠a y la estrategia en un entorno seguro. Te prepara para enfrentar negociaciones reales con m√°s confianza y herramientas para lograr resultados beneficiosos para ambas partes.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center">
            <button id="start-game-btn" class="mt-8 bg-[var(--dorado)] text-[var(--azul-noche)] font-bold text-lg py-3 px-10 rounded-lg">
                ¬°Entendido, Iniciar Negociaci√≥n!
            </button>
        </div>
        </div>
    </main>
    <footer class="footer-component"></footer>

    <!-- Pantalla de Juego -->
    <div id="game-container" class="hidden w-full max-w-4xl mx-auto">
        <div class="bg-black/20 p-6 rounded-lg border border-white/10">
            <div class="mb-4 text-center">
                 <h2 class="font-serif text-2xl font-bold text-white">Negociando con "TechCorp"</h2>
                 <p class="text-sm text-gray-300">Tu Objetivo: Conseguir una comisi√≥n del 15% y un post en su blog.</p>
            </div>
            
            <div id="chat-window" class="h-96 overflow-y-auto p-4 space-y-4 bg-black/20 rounded-lg mb-4">
                <!-- Los mensajes del chat aparecer√°n aqu√≠ -->
            </div>

            <div id="options-area">
                <!-- Las opciones de di√°logo aparecer√°n aqu√≠ -->
            </div>
        </div>
    </div>

    <!-- Modal de Fin de Juego -->
    <div id="game-over-modal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50">
        <div class="bg-[var(--azul-noche)] border-2 border-[var(--dorado)] rounded-xl shadow-2xl w-full max-w-lg text-center p-8">
            <h2 id="game-over-title" class="font-serif text-4xl font-bold"></h2>
            <p id="game-over-feedback" class="text-[var(--texto-claro)] my-4"></p>
            <div class="bg-black/20 p-4 rounded-lg text-left text-sm mb-6">
                <h3 class="font-bold text-white mb-2">Resumen del Acuerdo:</h3>
                <p>Tu Comisi√≥n: <span id="final-commission" class="font-bold text-[var(--dorado)]"></span></p>
                <p>Post en su Blog: <span id="final-blog" class="font-bold text-[var(--dorado)]"></span></p>
            </div>
            <div class="flex gap-4 justify-center">
                <button id="info-back-btn" class="bg-gray-500 text-white font-bold text-lg py-3 px-8 rounded-lg">Ver Explicaci√≥n</button>
                <button id="play-again-btn" class="bg-[var(--dorado)] text-[var(--azul-noche)] font-bold text-lg py-3 px-8 rounded-lg">Jugar de Nuevo</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Elementos del DOM ---
            const infoScreen = document.getElementById('info-screen');
            const gameContainer = document.getElementById('game-container');
            const gameOverModal = document.getElementById('game-over-modal');
            const startGameBtn = document.getElementById('start-game-btn');
            const chatWindow = document.getElementById('chat-window');
            const optionsArea = document.getElementById('options-area');
            const gameOverTitle = document.getElementById('game-over-title');
            const gameOverFeedback = document.getElementById('game-over-feedback');
            const finalCommission = document.getElementById('final-commission');
            const finalBlog = document.getElementById('final-blog');
            const playAgainBtn = document.getElementById('play-again-btn');
            const infoBackBtn = document.getElementById('info-back-btn');

            // --- Estado del Juego ---
            let state;
            
            const dialogueTree = {
                start: {
                    partnerMessage: "Hola. Gracias por reunirte conmigo. Hemos revisado tu producto y es interesante. Cu√©ntame, ¬øqu√© tipo de alianza tienes en mente?",
                    options: [
                        { text: "Quiero una comisi√≥n del 20% por cada cliente que les refiera.", next: 'aggressive_start', score: -10 },
                        { text: "Creemos que una colaboraci√≥n podr√≠a beneficiarnos mutuamente. ¬øQu√© tal si exploramos algunas ideas juntos?", next: 'collaborative_start', score: 10 },
                        { text: "Nuestro producto es el mejor. Si lo promocionan, ambos ganaremos mucho dinero.", next: 'arrogant_start', score: -5 }
                    ]
                },
                aggressive_start: {
                    partnerMessage: "20% es una cifra muy alta para empezar sin datos. No podemos aceptar eso. Siendo realistas, podr√≠amos ofrecer un 8%.",
                    options: [
                        { text: "Imposible. Mi m√≠nimo es 18%.", next: 'negotiate_hard', score: -5 },
                        { text: "Entiendo. ¬øQu√© necesitar√≠an ver para considerar un n√∫mero m√°s cercano al 15%?", next: 'find_common_ground', score: 10 }
                    ]
                },
                collaborative_start: {
                    partnerMessage: "Me gusta ese enfoque. Para nosotros, es clave llegar a nuevos mercados. ¬øC√≥mo nos ayudar√≠a tu plataforma a lograr eso, m√°s all√° de una simple comisi√≥n?",
                    options: [
                        { text: "Adem√°s de referir clientes, podr√≠amos crear contenido juntos. Un post en su blog ser√≠a ideal.", next: 'propose_blog', score: 15 },
                        { text: "Mi plataforma tiene muchos usuarios. Eso es lo que les ofrezco.", next: 'negotiate_hard', score: -5 }
                    ]
                },
                arrogant_start: {
                     partnerMessage: "Agradecemos tu confianza en tu producto, pero necesitamos m√°s que eso. Hablemos de n√∫meros concretos. ¬øQu√© comisi√≥n buscas?",
                     options: [
                        { text: "Ok, vayamos al grano. Busco un 15% de comisi√≥n.", next: 'negotiate_hard', score: 5 },
                        { text: "Entiendo su punto. ¬øQu√© tal un 12% inicial, con la opci√≥n de subirlo si alcanzamos ciertas metas?", next: 'find_common_ground', score: 10 }
                    ]
                },
                propose_blog: {
                    partnerMessage: "Interesante. Un post conjunto podr√≠a funcionar. Si hacemos eso, podr√≠amos llegar a una comisi√≥n del 12%. ¬øTe parece justo?",
                    options: [
                        { text: "Acepto el 12% y el post en el blog. ¬°Trato hecho!", next: 'end_good', score: 10 },
                        { text: "Casi. ¬øPodemos cerrar en 15% y el post en el blog? Ser√≠a un verdadero ganar-ganar.", next: 'final_push', score: 5 }
                    ]
                },
                 find_common_ground: {
                    partnerMessage: "Necesitar√≠amos ver al menos 100 nuevos usuarios registrados en los primeros 3 meses. Si lo logras, podemos renegociar. Por ahora, te ofrezco un 10%.",
                     options: [
                        { text: "Ok, acepto el 10% con la revisi√≥n en 3 meses. Trato hecho.", next: 'end_ok', score: 5 },
                        { text: "Es muy bajo. ¬øQu√© tal si a√±aden un post en su blog para ayudarme a llegar a esa meta? A cambio, acepto el 10%.", next: 'propose_blog', score: 10 }
                    ]
                },
                negotiate_hard: {
                    partnerMessage: "Lo siento, pero las cifras que propones no son viables para nosotros en este momento. Quiz√°s deber√≠amos dejar esta conversaci√≥n para m√°s adelante.",
                    options: [
                        { text: "De acuerdo. Fin de la negociaci√≥n.", next: 'end_bad', score: -20 }
                    ]
                },
                final_push: {
                    partnerMessage: "Est√° bien. Tienes buenos argumentos. Aceptamos un 15% de comisi√≥n y el post en el blog. Tenemos un acuerdo.",
                     options: [
                        { text: "¬°Perfecto! Trato hecho.", next: 'end_win', score: 20 }
                    ]
                }
            };

            function showScreen(screen) {
                infoScreen.classList.add('hidden');
                gameContainer.classList.add('hidden');
                gameOverModal.classList.add('hidden');
                if (screen === 'info') infoScreen.classList.remove('hidden');
                if (screen === 'game') gameContainer.classList.remove('hidden');
                if (screen === 'game-over') gameOverModal.classList.remove('hidden');
            }

            function initGame() {
                state = {
                    score: 0,
                    commission: 0,
                    blogPost: false,
                    currentNode: 'start'
                };
                chatWindow.innerHTML = '';
                showScreen('game');
                displayNode('start');
            }
            
            function addMessage(text, sender) {
                const bubble = document.createElement('div');
                bubble.className = `chat-bubble p-3 rounded-lg w-fit ${sender === 'user' ? 'user self-end' : 'partner self-start'}`;
                bubble.textContent = text;
                chatWindow.appendChild(bubble);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }

            function displayNode(nodeId) {
                const node = dialogueTree[nodeId];
                if (!node) return;

                addMessage(node.partnerMessage, 'partner');
                
                optionsArea.innerHTML = '';
                if(node.options) {
                    node.options.forEach(option => {
                        const button = document.createElement('button');
                        button.className = 'option-button w-full text-left p-3 rounded-lg';
                        button.textContent = option.text;
                        button.onclick = () => selectOption(option);
                        optionsArea.appendChild(button);
                    });
                }
            }

            function selectOption(option) {
                addMessage(option.text, 'user');
                state.score += option.score;
                state.currentNode = option.next;
                
                // Deshabilitar botones
                document.querySelectorAll('.option-button').forEach(b => b.disabled = true);
                
                setTimeout(() => {
                    if (option.next.startsWith('end_')) {
                        endGame(option.next);
                    } else {
                        displayNode(option.next);
                    }
                }, 1000);
            }

            function endGame(endNode) {
                let title = '';
                let feedback = '';

                switch (endNode) {
                    case 'end_win':
                        title = '¬°Acuerdo Maestro!';
                        feedback = '¬°Excelente! Lograste tus objetivos y construiste una relaci√≥n s√≥lida. Esta es una verdadera alianza ganar-ganar.';
                        state.commission = 15;
                        state.blogPost = true;
                        break;
                    case 'end_good':
                        title = '¬°Buen Acuerdo!';
                        feedback = 'Conseguiste un trato favorable. Aunque no alcanzaste el m√°ximo, aseguraste valor adicional y mantuviste una buena relaci√≥n.';
                        state.commission = 12;
                        state.blogPost = true;
                        break;
                    case 'end_ok':
                        title = 'Acuerdo Aceptable';
                        feedback = 'Lograste un acuerdo, pero cediste en puntos importantes. Es una base para construir, pero podr√≠as haber obtenido m√°s.';
                         state.commission = 10;
                        state.blogPost = false;
                        break;
                    case 'end_bad':
                        title = 'Negociaci√≥n Rota';
                        feedback = 'Tu postura fue demasiado r√≠gida y la negociaci√≥n fracas√≥. A veces, es mejor un acuerdo aceptable que ning√∫n acuerdo.';
                        state.commission = 0;
                        state.blogPost = false;
                        break;
                }
                
                gameOverTitle.textContent = title;
                gameOverTitle.style.color = state.score > 20 ? '#22c55e' : (state.score > 5 ? 'var(--dorado)' : '#ef4444');
                gameOverFeedback.textContent = feedback;
                finalCommission.textContent = `${state.commission}%`;
                finalBlog.textContent = state.blogPost ? 'S√≠' : 'No';
                showScreen('game-over');
            }

            startGameBtn.addEventListener('click', initGame);
            playAgainBtn.addEventListener('click', initGame);
            infoBackBtn.addEventListener('click', () => showScreen('info'));
        });
    </script>
    <script src="../assets/js/components.js"></script>
</body>
</html>
