<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De Cien a Mil: 16. Simulador de Guerra de Precios</title>
    <style>
        :root {
            --color-night-blue: #0D223F;
            --color-gold: #D4AF37;
            --color-gold-dark: #B89B2E;
            --color-card-bg: #FFFFFF;
            --color-text-on-dark: #F0F0F0;
            --color-text-on-light: #0D223F;
            --color-border: #E0D6B3;
            --color-profit: #27ae60;
            --color-loss: #c0392b;
            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            font-family: var(--font-family);
            background-color: var(--color-night-blue);
            color: var(--color-text-on-dark);
            margin: 0;
            padding: 40px 20px;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        .container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            background: var(--color-card-bg);
            color: var(--color-text-on-light);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0, 0.2);
            overflow: hidden;
            border: 1px solid var(--color-gold);
        }
        .column {
            padding: 35px;
            flex-basis: 50%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        .pedagogical-column {
            background-color: var(--color-night-blue);
            color: var(--color-text-on-dark);
            border-right: 1px solid var(--color-gold);
        }
        .tool-column {
            background-color: var(--color-card-bg);
        }
        h1, h2 { margin-top: 0; }
        .pedagogical-column h1 { color: var(--color-card-bg); }
        .tool-column h2 { color: var(--color-night-blue); }
        h1 {
            font-size: 1.8em;
            border-bottom: 2px solid var(--color-gold);
            padding-bottom: 10px;
            margin-bottom: 25px;
        }
        h2 { font-size: 1.6em; }
        h3 {
            font-size: 1.2em;
            margin-top: 25px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            color: var(--color-gold);
        }
        h3 .icon { width: 24px; height: 24px; margin-right: 10px; fill: currentColor; }
        p, li { font-size: 0.95em; }
        ul { list-style: none; padding-left: 0; }
        ul li {
            padding-left: 1.5em;
            text-indent: -1.5em;
            margin-bottom: 5px;
        }
        ul li::before {
            content: '•';
            color: var(--color-gold);
            margin-right: 0.5em;
            font-size: 1.2em;
        }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input[type="number"] {
            width: 100%; padding: 10px;
            border: 1px solid var(--color-border); border-radius: 4px;
            box-sizing: border-box; font-size: 1em; color: var(--color-text-on-light);
        }
        button {
            background-color: var(--color-gold);
            color: var(--color-night-blue); border: none; padding: 12px 20px;
            border-radius: 5px; font-size: 1em; font-weight: bold;
            cursor: pointer; transition: background-color 0.3s, transform 0.1s;
            width: 100%; margin-top: 10px;
        }
        button:hover { background-color: var(--color-gold-dark); }
        button:active { transform: scale(0.98); }

        #results-container {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .scenario-box {
            padding: 15px;
            border: 1px solid var(--color-border);
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .scenario-box h4 {
            margin: 0 0 10px 0;
            text-align: center;
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 5px;
        }
        .metric { font-size: 0.9em; display: flex; justify-content: space-between; margin-bottom: 5px; }
        .metric-label { color: #555; }
        .metric-value { font-weight: bold; }
        .total-profit {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid var(--color-night-blue);
        }
        .total-profit .metric-value {
            font-size: 1.5em;
            color: var(--color-night-blue);
        }
        #summary {
            grid-column: 1 / -1;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            padding: 10px;
            border-radius: 5px;
        }

        @media (max-width: 900px) {
            body { padding: 0; }
            .container { flex-direction: column; border-radius: 0; max-width: 100%; }
            .pedagogical-column { border-right: none; border-bottom: 1px solid var(--color-gold); }
            #results-container { grid-template-columns: 1fr; }
        }
    </style>
 </head>
<body>

    <main data-entitlement="camino.fase3">
    <div class="container">
        <div class="column pedagogical-column">
            <h1>16. Simulador de Guerra de Precios</h1>
            
            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9v-2h2v2zm0-4H9V7h2v5zm4 4h-2v-2h2v2zm0-4h-2V7h2v5z"></path></svg>
                Objetivo
            </h3>
            <p>Modelar el impacto financiero real de una guerra de precios, demostrando cómo una reducción de precios requiere un aumento masivo en el volumen de ventas solo para mantener el mismo nivel de beneficio.</p>

            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"></path></svg>
                Importancia Estratégica
            </h3>
            <p>Las guerras de precios son una trampa mortal para las empresas en crecimiento. Este simulador actúa como un freno de emergencia, obligando a los líderes a cuantificar las consecuencias antes de tomar una decisión impulsiva que puede destruir la rentabilidad y el valor de la marca a largo plazo.</p>

            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>
                Para Quién Es
            </h3>
            <p>Para CEOs, CFOs y Jefes de Venta que se enfrentan a una competencia agresiva y necesitan un argumento basado en datos para resistir la tentación de bajar los precios.</p>

            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg>
                Instrucciones de Uso
            </h3>
            <ul>
                <li><strong>Define tu Situación Actual:</strong> Ingresa tu precio, coste y volumen de ventas.</li>
                <li><strong>Plantea el Escenario:</strong> Define qué porcentaje de reducción de precio estás considerando.</li>
                <li><strong>Estima el Aumento de Ventas:</strong> Sé realista al estimar cuánto aumentará tu volumen de ventas.</li>
                <li><strong>Simula y Compara:</strong> La herramienta calculará el beneficio bruto en ambos escenarios para una comparación directa.</li>
            </ul>
        </div>
        <div class="column tool-column" data-when="granted">
            <h2>Herramienta Interactiva</h2>
            <div id="simulation-form">
                <div class="form-group">
                    <label>Precio de Venta Actual (€/unidad)</label>
                    <input type="number" id="current-price" value="100">
                </div>
                <div class="form-group">
                    <label>Coste Variable Actual (€/unidad)</label>
                    <input type="number" id="current-cost" value="60">
                </div>
                <div class="form-group">
                    <label>Volumen de Ventas Actual (unidades/mes)</label>
                    <input type="number" id="current-volume" value="1000">
                </div>
                 <hr style="border-top: 1px solid var(--color-border); margin: 20px 0;">
                 <div class="form-group">
                    <label>Reducción de Precio Propuesta (%)</label>
                    <input type="number" id="price-reduction" value="10" min="0" max="100">
                </div>
                <div class="form-group">
                    <label>Aumento de Ventas Esperado (%)</label>
                    <input type="number" id="volume-increase" value="20" min="0">
                </div>
                <button id="simulate-btn">Simular Impacto</button>
            </div>
            
            <div id="results-container" style="display:none;">
                <!-- Results will be injected here -->
            </div>
        </div>
        <div data-when="denied" class="hidden"></div>
    </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const currentPriceInput = document.getElementById('current-price');
            const currentCostInput = document.getElementById('current-cost');
            const currentVolumeInput = document.getElementById('current-volume');
            const priceReductionInput = document.getElementById('price-reduction');
            const volumeIncreaseInput = document.getElementById('volume-increase');
            const simulateBtn = document.getElementById('simulate-btn');
            const resultsContainer = document.getElementById('results-container');

            simulateBtn.addEventListener('click', runSimulation);

            function runSimulation() {
                const currentPrice = parseFloat(currentPriceInput.value);
                const currentCost = parseFloat(currentCostInput.value);
                const currentVolume = parseFloat(currentVolumeInput.value);
                const priceReduction = parseFloat(priceReductionInput.value) / 100;
                const volumeIncrease = parseFloat(volumeIncreaseInput.value) / 100;

                if (isNaN(currentPrice) || isNaN(currentCost) || isNaN(currentVolume) || isNaN(priceReduction) || isNaN(volumeIncrease)) {
                    alert('Por favor, introduce valores numéricos válidos en todos los campos.');
                    return;
                }
                 if (currentPrice <= currentCost) {
                    alert('El precio de venta debe ser mayor que el coste.');
                    return;
                }

                // Current scenario
                const currentMargin = currentPrice - currentCost;
                const currentProfit = currentMargin * currentVolume;

                // War scenario
                const newPrice = currentPrice * (1 - priceReduction);
                const newVolume = currentVolume * (1 + volumeIncrease);
                const newMargin = newPrice - currentCost;
                const newProfit = newMargin * newVolume;
                
                const profitDifference = newProfit - currentProfit;
                const profitDiffPercent = (profitDifference / currentProfit) * 100;

                const currencyFormatter = new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' });
                
                let summaryHTML = '';
                if (profitDifference > 0) {
                    summaryHTML = `<div id="summary" style="background-color: #eafaf1; color: var(--color-profit);">El beneficio AUMENTARÍA en ${currencyFormatter.format(profitDifference)} (${profitDiffPercent.toFixed(1)}%)</div>`;
                } else {
                     summaryHTML = `<div id="summary" style="background-color: #fbeee C; color: var(--color-loss);">El beneficio CAERÍA en ${currencyFormatter.format(Math.abs(profitDifference))} (${profitDiffPercent.toFixed(1)}%)</div>`;
                }

                resultsContainer.innerHTML = `
                    <div class="scenario-box">
                        <h4>Escenario Actual</h4>
                        <div class="metric"><span class="metric-label">Precio/u:</span> <span class="metric-value">${currencyFormatter.format(currentPrice)}</span></div>
                        <div class="metric"><span class="metric-label">Margen/u:</span> <span class="metric-value">${currencyFormatter.format(currentMargin)}</span></div>
                        <div class="metric"><span class="metric-label">Ventas:</span> <span class="metric-value">${currentVolume} u.</span></div>
                        <div class="total-profit"><span class="metric-label">Beneficio Bruto:</span> <span class="metric-value">${currencyFormatter.format(currentProfit)}</span></div>
                    </div>
                    <div class="scenario-box">
                        <h4>Guerra de Precios</h4>
                        <div class="metric"><span class="metric-label">Precio/u:</span> <span class="metric-value">${currencyFormatter.format(newPrice)}</span></div>
                        <div class="metric"><span class="metric-label">Margen/u:</span> <span class="metric-value">${currencyFormatter.format(newMargin)}</span></div>
                        <div class="metric"><span class="metric-label">Ventas:</span> <span class="metric-value">${Math.round(newVolume)} u.</span></div>
                        <div class="total-profit"><span class="metric-label">Beneficio Bruto:</span> <span class="metric-value">${currencyFormatter.format(newProfit)}</span></div>
                    </div>
                    ${summaryHTML}
                `;
                
                resultsContainer.style.display = 'grid';
            }
        });
    </script>

    <script src="../../assets/js/components.js"></script>
    <script src="../../assets/js/entitlements.js"></script>
</body>
</html>
